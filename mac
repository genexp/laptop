#!/usr/bin/env zsh

successfully() {
  $* || (echo "failed" 1>&2 && exit 1)
}

echo "Checking for SSH key, generating one if it doesn't exist ..."
  [[ -f ~/.ssh/id_rsa.pub ]] || ssh-keygen -t rsa

echo "Fixing permissions ..."
  successfully sudo chown -R `whoami` /usr/local

echo "Installing Homebrew, a good OS X package manager ..."
  successfully ruby <(curl -fsS https://raw.github.com/mxcl/homebrew/go)
  successfully brew update

echo "Putting Homebrew location earlier in PATH ..."
  successfully echo "
# recommended by brew doctor
export PATH='/usr/local/bin:$PATH'" >> ~/.zshenv
  successfully source ~/.zshenv

echo "Installing GNU Compiler Collection and dependencies ..."
  successfully brew tap homebrew/dupes
  successfully brew install coreutils

echo "Installing git ..."
  successfully brew install git

echo "Installing node.js, a good JavaScript application framework ..."
  successfully brew install node

echo "Installing Z Script, for quick access to recently used projects from the terminal ..."
  successfully brew install z

echo "Installing Essential NPM Packages - Grunt, Yeoman and Bower, because you need them ..."
  successfully npm install -g yo grunt-cli bower

echo "Installing critical Ruby gems for development ..."
  successfully gem install bundler rails compass --no-rdoc --no-ri

echo "Your shell will now restart in order for changes to apply."
  exec $SHELL -l
